# SAM-VMNet

[![SAM-VMNet](https://img.shields.io/badge/Hugging%20Face-Models-c93837?style=flat-square)](https://huggingface.co/ly17/SAM-VMNet)![GitHub stars](https://img.shields.io/github/stars/qimingfan10/SAM-VMNet)![GitHub forks](https://img.shields.io/github/forks/qimingfan10/SAM-VMNet)


This is the official code repository for "Deep learning model for coronary artery segmentation and quantitative stenosis detection in angiographic images", which is accpeted by **Medical Physics** as a research article!

![Framework Architecture](samvm-net.jpg)
*Figure 1: The overall architecture of SAM-VMNet combining VMUnet (Vision-based Medical Network) with SAM (Segment Anything Model)*


## Prepare

To set up the project, follow these steps:

**Clone the repository**:

   ```bash
   git clone https://github.com/qimingfan10/SAM-VMNet.git
   cd SAM-VMNet
   ```

## 0. Environments

   ```bash
   pip install -r requirements.txt
   ```

The .whl files of mamba_ssm could be found [here](https://github.com/state-spaces/mamba/releases).
The .whl files of causal_conv1d could be found [here](https://github.com/Dao-AILab/causal-conv1d/releases).

## 1. Download the pre-trained weights

   1. Download the following files from Google Drive and place them in the `SAM-VMNet/VM-UNet/pre_trained_weights` directory:
     - [vmamba_small_e238_ema.pth](https://drive.google.com/file/d/1XL7JuacjoZCr8w2b0c8CaQn8b0hREblk/view?usp=drive_link)
     - [best-epoch142-loss0.3230.pth](https://drive.google.com/file/d/1OKIzUM_L6FeEqyuIsAMn4x-FHptizTkG/view?usp=drive_link)
     - [best-epoch142-loss0.3488.pth](https://drive.google.com/file/d/1jsZKakA4FrYaMXNp6qkVtxXwwcJQKrW4/view?usp=drive_link)

  2. Download the following file from Google Drive and place it in the `SAM-VMNet/MedSAM-main/work_dir/MedSAM` directory:
     - [MedSAM_model.pth](https://drive.google.com/file/d/1O5IVkcVxd2RtOcZEKuTR3WkOBiosHBfz/view?usp=drive_link)

## 2. Prepare the datasets

Download the [ARCADE](https://zenodo.org/records/10390295) from zenodo and place them in the `./data` directory.

## 3. Train the SAM-VMNet

```
bash train.sh
```

## 4. Test the SAM-VMNet

```
bash test.sh
```


## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for more details.

## Citation

If you use this project in your research, please cite the following paper:

```bibtex
@article{https://doi.org/10.1002/mp.17970,
author = {Huang, Baixiang and Luo, Yu and Wei, Guangyu and He, Songyan and Shao, Yushuang and Zeng, Xueying and Zhang, Qing},
title = {Deep learning model for coronary artery segmentation and quantitative stenosis detection in angiographic images},
journal = {Medical Physics},
volume = {52},
number = {7},
pages = {e17970},
doi = {https://doi.org/10.1002/mp.17970},
year = {2025}
}
```

---

For any questions or issues, please open an issue on this repository.
